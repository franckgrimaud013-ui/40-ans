<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Les Traîtres — version stable (titre + panneaux + skip fix)</title>
<style>
:root{
  --bg:#070c16; --ink:#eaf0f8; --mut:#cfd5dc; --gold:#ffd87a;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;overflow:hidden}
a{color:var(--gold)}

.page{position:absolute; inset:0; display:none; padding:24px 14px; overflow:auto; -webkit-overflow-scrolling:touch}
.page.active{display:block}

.wrap{max-width:980px; margin:0 auto}
.center{text-align:center}
.hero{font-size: clamp(28px, 5vw, 48px); font-weight:900; line-height:1.05; letter-spacing:.5px;
  text-shadow:0 0 18px rgba(255,216,122,.22)}
.sub{font-size:clamp(16px, 2.4vw, 20px); color:var(--mut)}
.mt{margin-top:16px}

.btn{display:inline-block; background:var(--gold); color:#000; border:none; padding:12px 18px;
  border-radius:14px; font-weight:900; cursor:pointer; text-decoration:none; font-size:16px; box-shadow:0 6px 22px rgba(0,0,0,.25)}
.btn:active{transform:translateY(1px)}
.btn-ghost{background:transparent; border:1px solid rgba(255,255,255,.2); color:var(--ink)}

.panel{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:16px}
.grid{display:grid; gap:12px}
@media(min-width:860px){ .grid.two{grid-template-columns:1fr 1fr} }

/* >>> Ajouts demandés <<< */
/* Titre blanc + halo sur la 3e page */
#p3Title{
  color:#fff;
  font-size:clamp(20px, 3.2vw, 28px);
  font-weight:900;
  line-height:1.15;
  text-shadow:0 0 14px rgba(255,255,255,.35);
  margin:0 0 10px;
}
/* Panneaux règles/planning : fond noir semi-transparent */
.panel-dark{
  background:rgba(0,0,0,.60) !important;
  border:1px solid rgba(255,255,255,.12) !important;
  box-shadow:0 10px 30px rgba(0,0,0,.30);
}

/* secret skip button */
.secret-fixed{
  position:fixed; top:10px; left:10px; width:18px; height:18px; border-radius:50%;
  z-index:9999; cursor:pointer; opacity:.35;
  background:radial-gradient(circle at 30% 30%, rgba(212,175,55,.95) 0%, rgba(212,175,55,.45) 45%, rgba(0,0,0,0) 60%);
  box-shadow:0 0 14px rgba(212,175,55,.55), 0 0 28px rgba(212,175,55,.35);
  transition:opacity .25s ease;
}
.secret-fixed:hover{opacity:.55}
.app-shown .secret-fixed{display:none}
</style>
</head>
<body>
<!-- Bouton secret pour passer l'intro -->
<div id="secretFixed" class="secret-fixed" title="Passer l’intro"></div>

<!-- Page 1 : accueil -->
<section id="p1" class="page active intro-layer">
  <div class="wrap center" style="margin-top:16vh">
    <div class="hero">Vous avez été conviés par Franck…</div>
    <p class="sub mt">Un week‑end pas comme les autres vous attend.<br>🔊 Mettez le son… chaque détail compte.</p>
    <div class="mt">
      <button id="startBtn" class="btn">Lancez‑vous</button>
    </div>
  </div>
</section>

<!-- Page 2 : intro / règles résumées -->
<section id="p2" class="page intro-layer">
  <div class="wrap" style="margin-top:8vh">
    <div class="panel">
      <h2 class="center" style="margin:0 0 8px">Tu vas bientôt découvrir ton rôle…</h2>
      <p class="center sub">On est entre amis — le but est de s’amuser 😉</p>
      <div class="grid two mt">
        <div class="panel panel-dark">
          <h3>🗓️ Le petit planning</h3>
          <ul>
            <li><b>Vendredi soir</b> : conseil et vote.</li>
            <li><b>Nuit ven→sam</b> : les Traîtres éliminent secrètement un Loyal via leur lien.</li>
            <li><b>Samedi matin</b> : annonce au groupe du résultat de la nuit.</li>
            <li><b>Samedi midi</b> : nouveau vote.</li>
            <li><b>Samedi soir</b> : vote.</li>
            <li><b>Nuit sam→dim</b> : les Traîtres éliminent à nouveau.</li>
            <li><b>Dimanche matin</b> : annonce finale.</li>
          </ul>
        </div>
        <div class="panel panel-dark">
          <h3>🎭 Esprit & règles</h3>
          <ul>
            <li>Les Traîtres jouent <b>en secret</b> via un lien privé.</li>
            <li>Les Loyaux observent, discutent et votent.</li>
            <li>Fun & fair‑play à tout moment.</li>
          </ul>
        </div>
      </div>
      <div class="center mt">
        <button id="enterBtn" class="btn">Entrer dans le jeu</button>
      </div>
    </div>
  </div>
</section>

<!-- Page 3 : planning + Découvre ton rôle -->
<section id="p3" class="page">
  <div class="wrap" style="margin: 6vh auto 10vh">
    <div class="panel panel-dark">
      <h2 id="p3Title">Franck a créé ce jeu pour pimenter le week‑end…</h2>
      <p class="sub">Tout est bon enfant, le but est de s’amuser — gardez votre rôle secret 😉</p>
      <div class="center" style="margin-top:10px">
        <button id="discoverBtn" class="btn">Découvre ton rôle</button>
      </div>
    </div>

    <div id="roleMount" class="panel panel-dark" style="max-width:720px; margin:18px auto 64px; display:none">
      <div id="roleBody"></div>
      <div id="roleFooter" style="text-align:right; margin-top:10px"></div>
    </div>
  </div>
</section>

<!-- (facultatif) votre audio d'intro si vous en avez un, gardez l'id -->
<audio id="bgAudio" preload="auto"></audio>

<script>
// === Navigation de base ===
const qs = s => document.querySelector(s);
function setPage(i){
  ['#p1','#p2','#p3'].forEach((id,idx)=>{
    const el = qs(id); if(!el) return;
    el.classList.toggle('active', idx===i);
  });
  if(i===2) document.documentElement.classList.add('app-shown');
}
qs('#startBtn').addEventListener('click', ()=> setPage(1));
qs('#enterBtn').addEventListener('click', ()=> setPage(2));

// === Bouton secret : passer l'intro SANS superposition ===
window.__introTimers = window.__introTimers || [];
function stopIntroAnimations() {
  try { qs('#bgAudio')?.pause(); } catch(e){}
  try {
    (window.__introTimers || []).forEach(id => { try{ clearTimeout(id); clearInterval(id); }catch(_){}});
    window.__introTimers = [];
  } catch(e){}
  const introSelectors = ['#p1','#p2','.intro','.intro-layer','.image-hero','.slide','.slides','.bg-intro','.overlay-intro'];
  introSelectors.forEach(sel => document.querySelectorAll(sel).forEach(el => el.style.display='none'));
  document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
  document.documentElement.classList.add('app-shown');
}
function goToPage3() {
  stopIntroAnimations();
  const p3 = document.getElementById('p3');
  if (p3) p3.classList.add('active');
  try { p3?.scrollTo({ top: 0, behavior: 'instant' }); } catch(e){}
}
(function(){
  const secret = document.getElementById('secretFixed');
  if (!secret) return;
  secret.addEventListener('click', goToPage3);
  let tId;
  secret.addEventListener('touchstart', () => { tId = setTimeout(goToPage3, 500); }, {passive:true});
  secret.addEventListener('touchend',   () => { if (tId) clearTimeout(tId); },     {passive:true});
})();

// === Démo d'insertion du rôle (à raccorder à ton système existant) ===
// Ici on ne tire pas les rôles, on montre seulement la structure d'affichage.
// Tu gardes ton script existant qui décide TRAÎTRE / LOYAL puis appelle showRole(isTraitor).
function showRole(isTraitor){
  const mount = qs('#roleMount');
  const body  = qs('#roleBody');
  const foot  = qs('#roleFooter');
  mount.style.display = 'block';
  body.innerHTML = isTraitor
    ? '<h2 style="margin:.2rem 0;color:#ffd87a">TRAÎTRE</h2><p>Tu fais partie des Traîtres. Reste discret, influence les votes, et élimine un Loyal chaque nuit.</p>'
    : '<h2 style="margin:.2rem 0;color:#a4c8ff">LOYAL</h2><p>Tu es Loyal. Observe, discute et vote pour démasquer les Traîtres.</p>';
  // IMPORTANT : garde le bouton avec ton lien réel et le token si besoin
  foot.innerHTML = isTraitor
    ? '<a class="btn" href="traitor_vote.html" target="_blank" rel="noopener">Voter la nuit pour éliminer un Loyal</a>'
    : '<button class="btn btn-ghost" onclick="document.getElementById(\'roleMount\').style.display=\'none\'">Fermer</button>';
}
// Branche "Découvre ton rôle" sur une démo neutre (à remplacer par ta logique réelle)
document.getElementById('discoverBtn').addEventListener('click', ()=>{
  // Remplace par ton code (token, firebase, etc.). Ici, simple toggle visuel pour tester :
  const flag = (window.__demoFlag = !window.__demoFlag);
  showRole(flag); // true => traître, false => loyal
});
</script>
</body>
</html>
