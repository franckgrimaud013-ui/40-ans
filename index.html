<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Les Traîtres – Intro</title>
  <style>
    html,body{margin:0;padding:0;height:100%;background:#000;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    *{box-sizing:border-box}
    .bg-gate{position:fixed;inset:0;z-index:1;background-image:url('Photo1.jpg');background-size:cover;background-position:center;background-repeat:no-repeat;transition:opacity 2s ease}
    #bgVideoLayer{position:fixed;inset:0;z-index:0;display:none;pointer-events:none}
    #bgVideoLayer .bgv{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(0.9);opacity:0;transition:opacity 2.4s ease-in-out}
    #bgVideoLayer .bgv.is-active{opacity:1;z-index:2}
    .overlay{position:relative;z-index:3}
    #introFade{position:fixed;inset:0;background:#000;opacity:0;pointer-events:none;z-index:2;transition:opacity 2s ease}
    #gateText{position:fixed;left:50%;bottom:7vh;transform:translateX(-50%);width:min(92vw,1100px);text-align:center}
    .btn-start{appearance:none;border:1px solid rgba(255,215,0,.7);background:radial-gradient(120% 120% at 50% -10%, rgba(255,215,0,.18), rgba(255,215,0,.06));color:#fff;padding:12px 22px;border-radius:999px;letter-spacing:.04em;text-transform:uppercase;font-weight:700;box-shadow:0 0 22px rgba(255,215,0,.22);transition:transform .15s ease, box-shadow .2s ease;cursor:pointer}
    .btn-start:hover{transform:translateY(-1px);box-shadow:0 0 28px rgba(255,215,0,.35)}
    .slide{position:relative;top:-16vh;padding:0 4vw;}
    h1{font-weight:800;margin:0 0 10px;font-size:clamp(22px,4vw,36px)}
    p{margin:10px 0;font-size:clamp(16px,2.2vw,22px);line-height:1.35}
    .muted{opacity:.85}
    #ctaOverlay{position:fixed;inset:auto 0 6vh 0;display:none;justify-content:center;z-index:4}
  </style>
</head>
<body>
  <div id="introFade"></div>
  <div class="bg-gate" aria-hidden="true"></div>
  <div id="gateText" class="overlay">
    <h1>Vous avez été conviés…</h1>
    <p class="muted">Un week‑end pas comme les autres vous attend.</p>
    <p style="margin-top:20px"><button id="startIntroBtn" class="btn-start">Lancez‑vous</button></p>
  </div>
  <div id="bgVideoLayer" aria-hidden="true">
    <video id="bgv1" class="bgv" muted playsinline preload="auto">
      <source src="videos/fond-boucle.mp4" type="video/mp4">
    </video>
    <video id="bgv2" class="bgv" muted playsinline preload="auto">
      <source src="videos/fond-boucle.mp4" type="video/mp4">
    </video>
  </div>
  <div class="overlay">
    <div class="slide" id="introSlide">
      <p>Vous êtes conviés pour un petit week‑end entre amis… pour célébrer les 40 ans de Franck.</p>
      <p>Un week‑end d’amitié, de rires, de bons repas… bref, une fête comme vous l’imaginez.</p>
      <p>Mais derrière cette fête se cache un jeu… discret, mais omniprésent.</p>
      <p>On m'a beaucoup parlé de vous…</p>
      <p>Certains traînent toujours des travaux jamais terminés.</p>
      <p>D’autres savent vendre des surgelés… même trop longtemps restés au congélateur.</p>
      <p>Il y en a dont les sourcils tombent quand le stress monte.</p>
      <p>Et d’autres ont cette rigueur implacable : les règles… toutes les règles… rien que les règles…</p>
      <p>Il y en a qui ont l’art de contredire… même quand, au fond, c’était une bonne idée.</p>
      <p>D’autres, au contraire, laissent tout glisser… rien n’est grave.</p>
      <p>Et puis, il y a celui qui n’aime pas ce type de jeu… mais qui, ce week‑end, ne pourra pas y échapper.</p>
      <p>Et bien sûr, des infirmières… prêtes à veiller sur chacun — mais elles aussi devront se méfier… ou devriez‑vous vous méfier d’elles ?</p>
      <p>Tout le monde se connaît depuis plusieurs années… Mais saurez‑vous reconnaître les traîtres cachés parmi vous ?</p>
      <p>À chaque repas, à chaque nuit, un conseil décidera d’un destin.</p>
      <p>Vous allez dans quelques instants connaître vos rôles…</p>
      <p class="muted">Que la partie commence…</p>
    </div>
  </div>
  <audio id="introMusic" preload="auto">
    <source src="musique.mp3" type="audio/mpeg">
  </audio>
  <div id="ctaOverlay"><button class="btn-start">Entrer dans le jeu</button></div>
  <script>
  (function(){
    const layer = document.getElementById('bgVideoLayer');
    if(!layer) return;
    const v1 = document.getElementById('bgv1');
    const v2 = document.getElementById('bgv2');
    const CROSSFADE = 2.0;
    let active = v1, next = v2, armed = false;
    function armLoop(video){
      if (armed) return;
      armed = true;
      const dur = video.duration || 0;
      if (!dur || !isFinite(dur)) {
        video.addEventListener('loadedmetadata', ()=>{ armed=false; armLoop(video); }, {once:true});
        return;
      }
      const tick = () => {
        if (video.paused || video.ended) return;
        const t = video.currentTime;
        if (dur - t <= CROSSFADE + 0.4) {
          next.currentTime = 0;
          next.play().catch(()=>{});
          active.classList.remove('is-active');
          next.classList.add('is-active');
          const old = active; active = next; next = old;
          armed = false;
          armLoop(active);
        } else {
          requestAnimationFrame(tick);
        }
      };
      requestAnimationFrame(tick);
    }
    function start(){
      try{
        v1.currentTime = 0; v2.currentTime = 0;
        v1.muted = true; v2.muted = true;
        v1.playsInline = true; v2.playsInline = true;
        v1.play().catch(()=>{});
        v2.load();
      }catch(e){}
      v1.classList.add('is-active');
      armLoop(v1);
    }
    window.__bgVideoStart = start;
  })();
  </script>
  <script>
  (function(){
    const fade = document.getElementById('introFade');
    const bgGate = document.querySelector('.bg-gate');
    const bgLayer = document.getElementById('bgVideoLayer');
    const music  = document.getElementById('introMusic');
    const startBtn = document.getElementById('startIntroBtn');
    const FADE_MS = 2000;
    if (music){ try{ music.pause(); music.currentTime = 0; }catch(e){} }
    if (bgLayer){ bgLayer.style.display = 'none'; }
    function startAll(){
      if (bgLayer) bgLayer.style.display = 'block';
      if (window.__bgVideoStart) window.__bgVideoStart();
      if (music){ try{ music.volume = 0.35; music.currentTime = 0; music.play().catch(()=>{}); }catch(e){} }
      if (fade) { fade.style.opacity = '0.35'; setTimeout(()=>fade.style.opacity='0', FADE_MS); }
      if (bgGate){ bgGate.style.opacity = '0'; }
    }
    if (startBtn){
      startBtn.addEventListener('click', (e)=>{
        e.preventDefault();
        setTimeout(startAll, 30);
      });
    }
  })();
  </script>
</body>
</html>
